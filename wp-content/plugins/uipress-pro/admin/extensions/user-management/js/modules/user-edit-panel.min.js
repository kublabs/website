var uipMediaUploader;export function moduleData(){return{props:{closePanel:Function,sendmessage:Function,groups:Object},inject:["appData","uipress"],data:function(){return{userID:this.$route.params.id,panelData:[],userFetched:!1,translations:this.appData.translations,recentActivity:{page:1,totalPages:0},user:{editData:[]},ui:{editing:!1,activityOpen:!0,pageViewsOpen:!0,userNotesOpen:!0}}},mounted:function(){this.getUserData(),this.$route.params.id&&void 0!==this.$route.params.id||this.$router.push("/")},computed:{},methods:{getUserData(){let i=this;jQuery.ajax({url:uip_user_app_ajax.ajax_url,type:"post",data:{action:"uip_get_user_data",security:uip_user_app_ajax.security,userID:i.userID,activityPage:i.recentActivity.page},success:function(e){let a=JSON.parse(e);a.error?uipNotification(a.error,{pos:"bottom-left",status:"danger"}):(i.panelData=a,i.userFetched=!0,i.recentActivity.totalPages=i.panelData.history.totalPages,i.user.editData=JSON.parse(JSON.stringify(i.panelData.user)))}})},updateUser(){let i=this,e=new FormData;e.append("action","uip_update_user"),e.append("security",uip_ajax.security),e.append("user",JSON.stringify(i.user.editData)),i.uipress.callServer(uip_ajax.ajax_url,e).then(e=>{let a=e;a.error?i.uipress.notify(a.message,"","error"):(i.uipress.notify(a.message,"","success"),i.appData.refreshTable())})},returnRoles(i){this.user.editData.roles=i},returnGroups(i){this.user.editData.uip_user_group=i},sendUserMessage(){this.closePanel(),this.sendmessage(this.user.editData)},chooseImage(){self=this,(uipMediaUploader=wp.media.frames.file_frame=wp.media({title:self.translations.chooseImage,button:{text:self.translations.chooseImage},multiple:!1})).on("select",function(){var i=uipMediaUploader.state().get("selection").first().toJSON();self.user.editData.uip_profile_image=i.url}),uipMediaUploader.open()}},template:' \n      <floating-panel closeRoute="/" v-if="userFetched">\n        \x3c!-- EDITING USER --\x3e\n        <div class="uip-flex uip-flex-grow uip-flex-column uip-max-h-100p" >\n        \n          <div class="uip-padding-m uip-border-bottom uip-flex uip-flex-column uip-row-gap-xs" >\n            <div class="uip-text-bold uip-text-xl">{{panelData.user.username}}</div>\n            <router-link :to="\'/users/\' + userID" class="uip-link-muted uip-no-underline">{{translations.viewUserProfile}}</router-link>\n          </div>\n          \n          <div class="uip-flex-grow uip-padding-m uip-border-bottom uip-overflow-auto">\n        \n            <div class="uip-flex uip-flex-column uip-row-gap-m">\n              <div class="uip-w-50p">\n                <div class="uip-margin-bottom-xs">{{translations.profileImage}}</div>\n                \n                \n                 <div class="">\n                   <div class="uip-background-muted uip-border-round uip-overflow-hidden uip-margin-top-s">\n                     <div v-if="user.editData.uip_profile_image" class="uip-background-grey uip-flex uip-flex-center uip-flex-middle uip-position-relative uip-scale-in-center">\n                       <img class="uip-max-h-120" :src="user.editData.uip_profile_image">\n                     </div>\n                     <div class="uip-flex uip-flex-column uip-padding-xs uip-padding-bottom-remove uip-row-gap-xs">\n                       <div class="uip-flex uip-flex-column uip-flex-start uip-scale-in-center">\n                         <input class="uip-blank-input uip-no-wrap uip-text-ellipsis uip-overflow-hidden uip-w-100p" v-model="user.editData.uip_profile_image" :placeholder="translations.imageURL">\n                       </div>\n                     </div>\n                     <div class="uip-flex uip-flex-row uip-flex-between uip-flex-center uip-padding-xs">\n                       <div class="uip-flex uip-flex-row uip-gap-xs">\n                         <div class="uip-position-relative">\n                           <div class="uip-flex">\n                             <div class="uip-cursor-pointer" @click="chooseImage()">\n                               <div v-if="user.editData.uip_profile_image" class="uip-link-default uip-text-bold">{{translations.changeImage}}</div>\n                               <div v-else class="uip-link-default uip-text-bold">{{translations.chooseImage}}</div>\n                             </div>\n                           </div>\n                         </div>\n                       </div>\n                       <div v-if="user.editData.uip_profile_image" @click="user.editData.uip_profile_image = \'\'" class="uip-icon uip-text-l uip-icon-medium uip-link-danger">delete</div>\n                     </div>\n                   </div>\n                 </div>\n                \n              </div>\n              <div class="uip-grid-col-2 uip-grid-gap-m">\n                <div class="">\n                  <div class="uip-margin-bottom-xs">{{translations.firstName}}</div>\n                  <input type="text" class="uip-input uip-w-100p" v-model="user.editData.first_name">\n                </div>\n                <div class="">\n                  <div class="uip-margin-bottom-xs">{{translations.lastName}}</div>\n                  <input type="text" class="uip-input uip-w-100p"  v-model="user.editData.last_name">\n                </div>\n              </div>\n              <div>\n                <div class="uip-margin-bottom-xs">{{translations.email}}</div>\n                <input type="text" class="uip-input uip-w-100p"  v-model="user.editData.user_email">\n              </div>\n              <div class="uip-grid-col-2 uip-grid-gap-m">\n                <div class="">\n                  <div class="uip-margin-bottom-xs">{{translations.roles}}</div>\n                  <role-select :selected="user.editData.roles"\n                  :name="translations.assignRoles"\n                  :translations="translations"\n                  :single=\'false\'\n                  :placeholder="translations.searchRoles"\n                  :updateRoles="returnRoles"></role-select>\n                </div>\n              </div>\n              <div>\n                <div class="uip-margin-bottom-xs">{{translations.userNotes}}</div>\n                <textarea type="text" class="uip-input uip-w-100p" rows="10" v-model="user.editData.notes"></textarea>\n              </div>\n              \n            </div>\n          \n          </div>\n          \n          <div class="uip-padding-m">\n            <div class="uip-flex uip-flex-between">\n              <router-link :to="\'/\'" class="uip-button-default uip-no-underline">{{translations.cancel}}</router-link>\n              <button class="uip-button-primary" @click="updateUser()">{{translations.updateUser}}</button>\n            </div>\n          </div>\n          \n        </div>\n      </floating-panel>'}};